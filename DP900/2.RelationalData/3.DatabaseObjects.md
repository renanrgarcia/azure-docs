# Database Objects
## Schema
- A schema is a logical container for database objects, such as tables, views, and stored procedures. It provides a way to organize and manage these objects within a database.
- `dbo` is the default schema in SQL Server, and it stands for "database owner". If you do not specify a schema when creating a database object, it will be created in the `dbo` schema by default.
- Ex: 
```sql
CREATE SCHEMA Sales;

CREATE TABLE Sales.Orders (
    OrderID INT PRIMARY KEY,
    OrderDate DATE,
    CustomerID INT,
    TotalAmount DECIMAL(10, 2)
);

-- Here, we create a schema named "Sales" and then create a table named "Orders" within that schema: Sales.Orders 
```

## Constraints
- Constraints are rules that are applied to columns in a table to enforce data integrity and consistency.
- Types of constraints:
  - `PRIMARY KEY`: Uniquely identifies each record in a table.
  - `FOREIGN KEY`: Establishes a relationship between two tables by referencing the primary key of another table.
  - `UNIQUE`: Ensures that all values in a column are unique.
  - `CHECK`: Ensures that all values in a column satisfy a specific condition.
  - `NOT NULL`: Ensures that a column cannot have NULL values.
  

## Views
- A view is a virtual table based on the results of a SELECT query.
- They are used to simplify complex queries, enhance security by restricting access to specific data, and present data in a specific format.
- Ex: 
```sql
CREATE VIEW Deliveries
AS
SELECT o.OrderNo, o.OrderDate,
       c.FirstName, c.LastName, c.Address, c.City
FROM Order AS o JOIN Customer AS c
ON o.Customer = c.ID;
```
- You can query the view and filter the data in much the same way as a table:
```sql
SELECT OrderNo, OrderDate, LastName, Address
FROM Deliveries
WHERE City = 'Seattle';
```

## Materialized Views
- A materialized view is a database object that contains the results of a query and is stored on disk.
- Unlike regular views, materialized views are not updated automatically when the underlying data changes. Instead, they must be refreshed manually or on a schedule.
- Ex:
```sql
CREATE MATERIALIZED VIEW SalesSummary
AS
SELECT ProductID, SUM(Quantity) AS TotalQuantity, SUM(Price * Quantity) AS TotalSales
FROM Sales
GROUP BY ProductID;
```

## Stored Procedures
- A stored procedure is a precompiled collection of one or more SQL statements that can be executed as a single unit.
- Ex:
```sql
CREATE PROCEDURE RenameProduct
	@ProductID INT,
	@NewName VARCHAR(20)
AS
UPDATE Product
SET Name = @NewName
WHERE ID = @ProductID;
```
- You can execute the stored procedure using the following command:
```sql
EXEC RenameProduct @ProductID = 1, @NewName = 'New Product Name';
```

## Triggers
- A trigger is a special type of stored procedure that automatically executes in response to certain events on a particular table or view.
```sql
CREATE TRIGGER trgAfterInsert
ON Orders
AFTER INSERT
AS
BEGIN
   INSERT INTO OrderAudit (OrderID, Action)
   SELECT ID, 'INSERT' FROM inserted;
END;
```

## Indexes
- An index is a database object that improves the speed of data retrieval operations on a table.
- Types of indexes:
  - `Clustered Index`: Stores the actual data rows in the leaf nodes of the index. There can be only one clustered index per table.
  - `Non-Clustered Index`: Stores a pointer to the actual data rows. A table can have multiple non-clustered indexes.
- Ex:
```sql
CREATE INDEX idx_CustomerName
ON Customers (LastName, FirstName);

-- Here you can see the index being created on the LastName and FirstName columns of the Customers table.
```
- This creates a tree-based structure that allows for faster searches and retrievals of data based on these columns.
